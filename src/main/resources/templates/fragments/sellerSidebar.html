<!-- templates/fragments/sellerSidebar.html -->
<aside th:fragment="sellerSidebar" xmlns:th="http://www.thymeleaf.org"
       xmlns:sec="http://www.thymeleaf.org/extras/spring-security" th:if="${session.loginRole == 'SELLER'}"
       id="SELLER_SIDEBAR" data-frag="SELLER-SIDEBAR">

  <div class="sidebar-card">
    <div class="profile-box">
      <!-- 판매자 사이드바 프로필 -->
      <div class="profile-image">
        <img th:if="${sidebarImage != null}" th:src="${sidebarImage}" alt="판매자 프로필 이미지">

        <img th:unless="${sidebarImage != null}" th:src="@{/img/default-profile.png}" alt="기본 프로필 이미지">
      </div>
      <div class="profile-info">
        <a href="#" class="profile-badge">프로가이드 ></a>

        <!-- 닉네임 -->
        <div class="profile-name"
             th:text="${sellerPage != null && sellerPage.nickname != null
               ? sellerPage.nickname
               : (session.loginMember != null ? session.loginMember.nickname : '닉네임')}">
          닉네임
        </div>


        <!-- 역할 전환 -->
        <form th:action="@{/mypage/role/toBuyer}" method="post" style="margin-top:10px;"
              sec:authorize="isAuthenticated()">
          <input type="hidden" sec:csrf />
          <button type="submit" class="btn-role-switch">구매자 전환</button>
        </form>
      </div>
    </div>

    <nav class="mypage-nav">
      <div class="nav-title active">MY PAGE</div>
      <ul>
        <li><a href="#">상품</a>
          <ul>
            <li>
              <a th:href="@{/product/manage}"
                 th:classappend="${activePath != null and #strings.startsWith(activePath, '/product/manage')} ? ' is-active'">
                내 상품 목록
              </a>
            </li>
            <li>
              <a th:href="@{/product/upload}"
                 th:classappend="${activePath != null and #strings.startsWith(activePath, '/product/upload')} ? ' is-active'">
                상품 등록
              </a>
            </li>
          </ul>
        </li>
        <li><a href="#">판매 현황</a>
          <ul>
            <li>
              <a th:href="@{/order/seller/history}"
                 th:classappend="${activePath != null and #strings.startsWith(activePath, '/order/seller/history')} ? ' is-active'">
                판매 내역
              </a>
            </li>
          </ul>
        </li>
        <li><a href="#">문의 / 리뷰</a>
          <ul>
            <li>
              <a th:href="@{/chat/rooms/seller}"
                 th:classappend="${(activePath != null and #strings.startsWith(activePath, '/chat/rooms/seller')) ? ' is-active' : ''}">
                1:1 문의
              </a>
            </li>
            <li><a th:href="@{/review/seller/list}">상품 리뷰</a></li>
          </ul>
        </li>
        <li><a href="#">알림</a>
          <ul>
            <li><a href="#">공지사항</a></li>
            <li><a href="#">프로모션</a></li>
          </ul>
        </li>
        <li><a href="#">내 정보</a>
          <ul>
            <li>
              <a th:href="@{/mypage/seller/view}"
                 th:classappend="${(activePath != null and #strings.startsWith(activePath, '/mypage/seller/view')) ? ' is-active' : ''}">
                프로필
              </a>
            </li>
            <li>
              <a th:href="@{/members/verify-password(next='/members/password')}"
                 th:classappend="${(activePath != null and #strings.startsWith(activePath, '/members/password')) ? ' is-active' : ''}">
                비밀번호 변경
              </a>
            </li>
          </ul>
        </li>
      </ul>
    </nav>
  </div>
</aside>